import numpy as np
import matplotlib.pyplot as plt

def calc_y():
    N = 2000
    b_bt = 0.05
    n_bt = 2

    c = 2*np.sqrt(n_bt)

    T_max = 60
    y = []
    G = np.zeros((T_max,T_max))
    dG = np.zeros((T_max,T_max))
    S = np.ones((T_max,T_max)) * N
    G[0,0] = 1
    for r in range(T_max):
        for s in range(T_max):
            dG[r,s] = b_bt * S[r,s]*0.5*n_bt*c*np.sqrt(G[r,s])/N 
            if s+1 < T_max:
                G[r,s+1] = G[r,s]+dG[r,s]
                S[r,s+1] = S[r,s]-dG[r,s]
        break

    for s in S[0,:]:
        y.append((N-s)/N)
    # plt.scatter(range(len(y)), y, linewidths=1)
    # plt.show()
    return y