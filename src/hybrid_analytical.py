import numpy as np
import matplotlib.pyplot as plt


N = 2000
b_mms = 0.05
n_mms = 6
b_bt = 0.05
n_bt = 2

c = 2*np.sqrt(n_bt)

T_max = 60
y = []
G = np.zeros((T_max,T_max))
dG = np.zeros((T_max,T_max))
S = np.ones((T_max,T_max)) * N
G[0,0] = 1

y = []
dI_mms_list = []
I = [1]
S = [N - I[0]]

for i in range(T_max):
    dI_mms = b_mms*S[i]*(n_mms-1)*I[i]/N
    dI_mms_list.append(dI_mms)
    G[i, i] = sum(dI_mms_list)
    for r in range(i):
        for s in range(i-r-1):
            
            dG[r,s+r+1] = b_bt * S[r+s+r+1]*0.5*n_bt*c*np.sqrt(G[r,s+r+1])/N 
            # if s+1 < T_max:
                # G[r,s+1] = G[r,s]+dG[r,s]

dI_bt = np.sum(dI_mms_list)

    i_new = I[i] + dI_mms + dI_bt
    s_new = S[i] - dI_mms - dI_bt
    
    if i_new > N or s_new < 0:
        I.append(N)
        S.append(0)
        print(i)
        break
    else:
        I.append(i_new)
        # print(s_new)
        S.append(s_new)

for s in S:
    y.append((N-s)/N)